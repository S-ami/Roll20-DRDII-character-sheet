<html>
<body>

<div>
    <button type="action" name="act_character" >Postava</button>
    <button type="action" name="act_texts" >Spisy</button>
    <button type="action" name="act_companions" >Pomocníci</button>
</div>
<input type='hidden' class='sheet-tabstoggle' name='attr_sheetTab' value='character' />
<div class="sheet-character">
    <div>
        <h1>Deník postavy</h1>
    </div>
    <div>
<!--        <h1>&lt; LOGO?? TODO &gt;</h1>-->
    </div>
    <div class="sheet-two-col">
        <label>Jméno:&nbsp;<input type="text" name="attr_charname" /></label>
        <label>Rasová zvláštní schopnost:&nbsp;<input type="text" name="attr_race_ability" /></label>
        <label>Povahový rys:&nbsp;<input type="text" name="attr_personality_trait" /></label>
    </div>
    <div>
        <div class="sheet-threat-benefit">
            <label>Ohrožení:&nbsp;</label>
            <input type="number" name="attr_threat" />
            <label>Výhoda:&nbsp;</label>
            <input type="number" name="attr_benefit" />
        </div>
        <div class="sheet-resourses">
            <div class="sheet-two-col">
                <h3>Vlastnosti</h3>
            </div>
            <div class="sheet-resourse-name">
                Tělo
            </div>
            <div>
                <button type="action" name="act_resoursebody1" class="custom-butt"><span name='attr_resoursebody1'></span></button>
                <button type="action" name="act_resoursebody2" class="custom-butt"><span name='attr_resoursebody2'></span></button>
                <button type="action" name="act_resoursebody3" class="custom-butt"><span name='attr_resoursebody3'></span></button>
                <button type="action" name="act_resoursebody4" class="custom-butt"><span name='attr_resoursebody4'></span></button>
                <button type="action" name="act_resoursebody5" class="custom-butt"><span name='attr_resoursebody5'></span></button>
                <button type="action" name="act_resoursebody6" class="custom-butt"><span name='attr_resoursebody6'></span></button>
                <button type="action" name="act_resoursebody7" class="custom-butt"><span name='attr_resoursebody7'></span></button>
                <button type="action" name="act_resoursebody8" class="custom-butt"><span name='attr_resoursebody8'></span></button>
                <button type="action" name="act_resoursebody9" class="custom-butt"><span name='attr_resoursebody9'></span></button>
                <button type="action" name="act_resoursebody10" class="custom-butt"><span name='attr_resoursebody10'></span></button>
            </div>
            <div class="sheet-resourse-name">
                Duše:
            </div>
            <div>
                <button type="action" name="act_resoursespirit1" class="custom-butt"><span name='attr_resoursespirit1'></span></button>
                <button type="action" name="act_resoursespirit2" class="custom-butt"><span name='attr_resoursespirit2'></span></button>
                <button type="action" name="act_resoursespirit3" class="custom-butt"><span name='attr_resoursespirit3'></span></button>
                <button type="action" name="act_resoursespirit4" class="custom-butt"><span name='attr_resoursespirit4'></span></button>
                <button type="action" name="act_resoursespirit5" class="custom-butt"><span name='attr_resoursespirit5'></span></button>
                <button type="action" name="act_resoursespirit6" class="custom-butt"><span name='attr_resoursespirit6'></span></button>
                <button type="action" name="act_resoursespirit7" class="custom-butt"><span name='attr_resoursespirit7'></span></button>
                <button type="action" name="act_resoursespirit8" class="custom-butt"><span name='attr_resoursespirit8'></span></button>
                <button type="action" name="act_resoursespirit9" class="custom-butt"><span name='attr_resoursespirit9'></span></button>
                <button type="action" name="act_resoursespirit10" class="custom-butt"><span name='attr_resoursespirit10'></span></button>
            </div>
            <div class="sheet-resourse-name">
                Vliv:
            </div>
            <div>
                <button type="action" name="act_resourseinfluence1" class="custom-butt"><span name='attr_resourseinfluence1'></span></button>
                <button type="action" name="act_resourseinfluence2" class="custom-butt"><span name='attr_resourseinfluence2'></span></button>
                <button type="action" name="act_resourseinfluence3" class="custom-butt"><span name='attr_resourseinfluence3'></span></button>
                <button type="action" name="act_resourseinfluence4" class="custom-butt"><span name='attr_resourseinfluence4'></span></button>
                <button type="action" name="act_resourseinfluence5" class="custom-butt"><span name='attr_resourseinfluence5'></span></button>
                <button type="action" name="act_resourseinfluence6" class="custom-butt"><span name='attr_resourseinfluence6'></span></button>
                <button type="action" name="act_resourseinfluence7" class="custom-butt"><span name='attr_resourseinfluence7'></span></button>
                <button type="action" name="act_resourseinfluence8" class="custom-butt"><span name='attr_resourseinfluence8'></span></button>
                <button type="action" name="act_resourseinfluence9" class="custom-butt"><span name='attr_resourseinfluence9'></span></button>
                <button type="action" name="act_resourseinfluence10" class="custom-butt"><span name='attr_resourseinfluence10'></span></button>
            </div>
        </div>
        <div class="sheet-scars">
            <div>
                <h3>Jizva</h3>
            </div>
            <div>
                <h3>Úroveň</h3>
            </div>
            <div class="sheet-two-col">
                <fieldset class="repeating_scars">
                    <div>
                        <input type="text" name="attr_scarname"/>
                    </div>
                    <div>
                        <input type="number" name="attr_scartier"/>
                    </div>
                </fieldset>
            </div>
        </div>
    </div>
    <div>
        <div class="sheet-race-proffesion">
            <div class="sheet-two-col">
                <h3>Rasa (kultura)</h3>
            </div>
            <div class="sheet-two-col" style="margin-bottom: 15px">
                <input type="text" name="attr_source_race" class="sheet-full-width" />
            </div>
            <div>
                <h3>Povolání</h3>
            </div>
            <div>
                <h3>Úroveň</h3>
            </div>
        </div>
        <div>
            <fieldset class="repeating_proffesions">
                <div>
                    <input type="text" name="attr_proffesionname"/>
                </div>
                <div>
                    <input type="number" name="attr_proffesionlevel"/>
                </div>
            </fieldset>
        </div>
    </div>
    <div>
        <h3>Vybavení</h3>
        <textarea name="attr_equipment"></textarea>
        <label>Naložení:&nbsp;<button type="action" class="custom-butt" name="act_load"><span name='attr_load'></span></button></label>
    </div>
    <div>
        <h3>Zbraně a zbroje</h3>
        <textarea name="attr_weapons_and_armour"></textarea>
    </div>
    <div>
        <label>Suroviny:&nbsp;<input type="text" name="attr_materials" /></label>
    </div>
    <div class="sheet-currency">
        <div>
            <label>Groše:&nbsp;<input type="text" name="attr_grose" /></label>
        </div>
        <div>
            <label>Haléře:&nbsp;<input type="text" name="attr_halere" /></label>
        </div>
        <div>
            <label>Dukáty:&nbsp;<input type="text" name="attr_dukaty" /></label>
        </div>
    </div>
    <div>
         <label>Úroveň:&nbsp;<input type="text" name="attr_level" /></label>
    </div>
    <div>
         <label>Volné zkušenosti:&nbsp;<input type="text" name="attr_free_experience" /></label>
    </div>
    <div>
        <h4>Zvláštní schopnosti</h4>
        <div>
            <fieldset class="repeating_specialabilities">
                <input type="text" name="attr_specialability" class="sheet-full-width sheet-two-col" />
            </fieldset>
        </div>
    </div>
    <div class="sheet-two-col">
        <img src="https://raw.githubusercontent.com/samik027/Roll20-DRDII-character-sheet/2be1e7ca8261a565903a840e5a5fc30354133c19/actionbar.svg" />
    </div>

</div>
<div class="sheet-texts">
    <div class="sheet-two-col">
        <h1>Spisy</h1>
    </div>
    <div class="sheet-two-col">
        <h3>Příběh hrdiny</h3>
        <textarea name="attr_story"></textarea>
    </div>
    <div class="sheet-two-col">
        <h3>Poznámky</h3>
        <textarea name="attr_notes"></textarea>
    </div>
</div>

<div class="sheet-companions">
    <div class="sheet-two-col">
        <fieldset class="repeating_companions">
            <div>
                <label>Jméno:&nbsp;<input type="text" name="attr_compname"/></label>
            </div>
            <div>
                <label>Sudba:&nbsp;<input type="number" name="attr_compresources"/></label>
            </div>
            <div>
                <label>Charakteristika:&nbsp;<textarea name="attr_comprcharacteristic"></textarea></label>
            </div>
            <div>
                <label>Zvláštní schopnosti<textarea name="attr_comprspecialabilities"></textarea></label>
            </div>
            <div>
                <label>Poznámky<textarea name="attr_comprnotes"></textarea></label>
            </div>
        </fieldset>
    </div>
</div>

<script type="text/worker">
    const buttonlist = ["character", "texts", "companions"];
    buttonlist.forEach(button => {
        on(`clicked:${button}`, function () {
            setAttrs({
                sheetTab: button
            });
        });
    });
    let resoursebtns = [];
    for (let i = 0; i < 15; i++) {
        resoursebtns.push('resoursebody' + i);
        resoursebtns.push('resoursespirit' + i);
        resoursebtns.push('resourseinfluence' + i);
    }
    resoursebtns.forEach(button => {
        on(`clicked:${button}`, function () {
            getAttrs([button], function (v) {
                let val = Object.values(v)[0];
                let newVal = "X";
                if (val === 'X') {
                    newVal = '—';
                } else if (val === '—') {
                    newVal = "|";
                } else if (val === '|') {
                    newVal = " ";
                }
                setAttrs({
                    [button]: newVal
                });
            });
        });
    });

    const btnLoad = ['load'];
    btnLoad.forEach(button => {
        on(`clicked:${button}`, function () {
            getAttrs([button], function (v) {
                let val = parseInt(Object.values(v)[0],10), newVal = 0;
                if (!isNaN(val)) {
                    if (val < 5) {
                        newVal = ++val;
                    }
                }

                setAttrs({
                    [button]: newVal
                });
            });
        });
    });
</script>


</body>
</html>