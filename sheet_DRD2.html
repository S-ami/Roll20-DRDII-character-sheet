<div>
    <button type="action" name="act_character" >Postava</button>
    <button type="action" name="act_texts" >Spisy</button>
    <button type="action" name="act_companions" >Pomocníci</button>
</div>
<input type='hidden' class='sheet-tabstoggle' name='attr_sheetTab' value='character' />
<div class="sheet-character">
    <div>
        <h1>Deník postavy</h1>
    </div>
    <div class="sheet-two-col character-basics flex-column">
        <div class="sheet-basics-child flex-row"><label>Jméno:&nbsp;</label><input type="text" name="attr_charname" /></div>
        <div class="sheet-basics-child flex-row"><label>Rasová zvláštní schopnost:&nbsp;</label><input type="text" name="attr_race_ability" /></div>
        <div class="sheet-basics-child flex-row"><label>Povahový rys:&nbsp;</label><input type="text" name="attr_personality_trait" /></div>
    </div>
    <div>
        <div class="sheet-threat-benefit">
            <label>Ohrožení:&nbsp;</label>
            <input type="number" name="attr_threat" />
            <label>Výhoda:&nbsp;</label>
            <input type="number" name="attr_benefit" />
        </div>
        <div class="sheet-resourses">
            <div class="sheet-two-col">
                <h3>Vlastnosti</h3>
            </div>
            <div class="sheet-resourse-name">
                Tělo:
            </div>
            <div>
                <button type="action" name="act_resoursebody1" class="custom-butt"><span name='attr_resoursebody1'></span></button>
                <button type="action" name="act_resoursebody2" class="custom-butt"><span name='attr_resoursebody2'></span></button>
                <button type="action" name="act_resoursebody3" class="custom-butt"><span name='attr_resoursebody3'></span></button>
                <button type="action" name="act_resoursebody4" class="custom-butt"><span name='attr_resoursebody4'></span></button>
                <button type="action" name="act_resoursebody5" class="custom-butt"><span name='attr_resoursebody5'></span></button>
                <button type="action" name="act_resoursebody6" class="custom-butt"><span name='attr_resoursebody6'></span></button>
                <button type="action" name="act_resoursebody7" class="custom-butt"><span name='attr_resoursebody7'></span></button>
                <button type="action" name="act_resoursebody8" class="custom-butt"><span name='attr_resoursebody8'></span></button>
                <button type="action" name="act_resoursebody9" class="custom-butt"><span name='attr_resoursebody9'></span></button>
                <button type="action" name="act_resoursebody10" class="custom-butt"><span name='attr_resoursebody10'></span></button>
            </div>
            <div class="sheet-resourse-name">
                Duše:
            </div>
            <div>
                <button type="action" name="act_resoursespirit1" class="custom-butt"><span name='attr_resoursespirit1'></span></button>
                <button type="action" name="act_resoursespirit2" class="custom-butt"><span name='attr_resoursespirit2'></span></button>
                <button type="action" name="act_resoursespirit3" class="custom-butt"><span name='attr_resoursespirit3'></span></button>
                <button type="action" name="act_resoursespirit4" class="custom-butt"><span name='attr_resoursespirit4'></span></button>
                <button type="action" name="act_resoursespirit5" class="custom-butt"><span name='attr_resoursespirit5'></span></button>
                <button type="action" name="act_resoursespirit6" class="custom-butt"><span name='attr_resoursespirit6'></span></button>
                <button type="action" name="act_resoursespirit7" class="custom-butt"><span name='attr_resoursespirit7'></span></button>
                <button type="action" name="act_resoursespirit8" class="custom-butt"><span name='attr_resoursespirit8'></span></button>
                <button type="action" name="act_resoursespirit9" class="custom-butt"><span name='attr_resoursespirit9'></span></button>
                <button type="action" name="act_resoursespirit10" class="custom-butt"><span name='attr_resoursespirit10'></span></button>
            </div>
            <div class="sheet-resourse-name">
                Vliv:
            </div>
            <div>
                <button type="action" name="act_resourseinfluence1" class="custom-butt"><span name='attr_resourseinfluence1'></span></button>
                <button type="action" name="act_resourseinfluence2" class="custom-butt"><span name='attr_resourseinfluence2'></span></button>
                <button type="action" name="act_resourseinfluence3" class="custom-butt"><span name='attr_resourseinfluence3'></span></button>
                <button type="action" name="act_resourseinfluence4" class="custom-butt"><span name='attr_resourseinfluence4'></span></button>
                <button type="action" name="act_resourseinfluence5" class="custom-butt"><span name='attr_resourseinfluence5'></span></button>
                <button type="action" name="act_resourseinfluence6" class="custom-butt"><span name='attr_resourseinfluence6'></span></button>
                <button type="action" name="act_resourseinfluence7" class="custom-butt"><span name='attr_resourseinfluence7'></span></button>
                <button type="action" name="act_resourseinfluence8" class="custom-butt"><span name='attr_resourseinfluence8'></span></button>
                <button type="action" name="act_resourseinfluence9" class="custom-butt"><span name='attr_resourseinfluence9'></span></button>
                <button type="action" name="act_resourseinfluence10" class="custom-butt"><span name='attr_resourseinfluence10'></span></button>
            </div>
        </div>
        <div class="sheet-scars">
            <div>
                <h3>Jizva</h3>
            </div>
            <div>
                <h3>Úroveň</h3>
            </div>
            <div class="sheet-two-col">
                <fieldset class="repeating_scars">
                    <div>
                        <input type="text" name="attr_scarname"/>
                    </div>
                    <div>
                        <input type="number" name="attr_scartier"/>
                    </div>
                </fieldset>
            </div>
        </div>
    </div>
    <div>
        <div class="sheet-race-proffesion">
            <div class="sheet-two-col">
                <h3>Rasa (kultura)</h3>
            </div>
            <div class="sheet-two-col" style="margin-bottom: 15px">
                <input type="text" name="attr_source_race" class="sheet-full-width" />
            </div>
            <div>
                <h3>Povolání</h3>
            </div>
            <div>
                <h3>Úroveň</h3>
            </div>
        </div>
        <div>
            <fieldset class="repeating_proffesions">
                <div>
                    <input type="text" name="attr_proffesionname"/>
                    <button name="roll_proffesion" type="roll" value="&{template:default}{{name=Hod na povolání}}{{@{proffesionname}=[[?{Typ|Standard, 2d6|Přesně, 3d6kh2|Nepřesně, 3d6kl2}+@{proffesionlevel}]]}}"></button>
                </div>
                <div>
                    <input type="number" name="attr_proffesionlevel"/>
                </div>
            </fieldset>
        </div>
    </div>
    <div>
        <h3>Vybavení</h3>
        <textarea name="attr_equipment"></textarea>
        <label>Naložení:&nbsp;<button type="action" class="custom-butt" name="act_load"><span name='attr_load'></span></button></label>
    </div>
    <div>
        <h3>Zbraně a zbroje</h3>
        <textarea name="attr_weapons_and_armour"></textarea>
    </div>
    <div>
        <label>Suroviny:&nbsp;<input type="text" name="attr_materials" /></label>
    </div>
    <div class="sheet-currency">
        <div>
            <label>Dukáty:&nbsp;<input type="text" name="attr_dukaty" /></label>
        </div>
        <div>
            <label>Groše:&nbsp;<input type="text" name="attr_grose" /></label>
        </div>
        <div>
            <label>Haléře:&nbsp;<input type="text" name="attr_halere" /></label>
        </div>
    </div>
    <div>
         <label>Úroveň:&nbsp;<input type="text" name="attr_level" /></label>
    </div>
    <div>
         <label>Volné zkušenosti:&nbsp;<input type="text" name="attr_free_experience" /></label>
    </div>
    <div class="sheet-two-col">
        <h4>Zvláštní schopnosti</h4>
        <div>
            <fieldset class="repeating_specialabilities">
                <input type="text" name="attr_specialability" class="sheet-full-width sheet-two-col" />
            </fieldset>
        </div>
    </div>
</div>

<div class="sheet-texts">
    <div class="sheet-two-col">
        <h1>Spisy</h1>
        <div class="sheet-texts-notes">
            <h3>Příběhové poznámky</h3>
            <textarea name="attr_notes"></textarea>
        </div>
        <div class="sheet-texts-story">
            <h3>Příběh hrdiny</h3>
            <textarea name="attr_story"></textarea>
        </div>
    </div>
</div>

<div class="sheet-companions">
    <div class="sheet-two-col">
        <h1>Pomocníci</h1>
    </div>
    <div class="sheet-two-col">
        <fieldset class="repeating_companions">
            <div class="sheet-flex-row">
                <label>Jméno:</label>&nbsp;<input type="text" name="attr_compname"/>
            </div>
            <div>
                <label>Sudba:&nbsp;<input type="number" name="attr_compresources"/></label>
            </div>
            <div>
                <label>Ohrožení:&nbsp;<input type="number" name="attr_compthreat"/></label>
            </div>
            <div>
                <label>Pouto:
                    <button type="action" name="aaa" class="custom-butt"><span name='aaa'></span></button>
                    <button type="action" name="bbb" class="custom-butt"><span name='bbb'></span></button>
                    <button type="action" name="ccc" class="custom-butt"><span name='ccc'></span></button>
                    <button type="action" name="ddd" class="custom-butt"><span name='ddd'></span></button>
                    <button type="action" name="eee" class="custom-butt"><span name='eee'></span></button>
                </label>
            </div>
            <div>
                <label>Charakteristika:&nbsp;<textarea name="attr_comprcharacteristic"></textarea></label>
            </div>
            <div>
                <label>Zvláštní schopnosti<textarea name="attr_comprspecialabilities"></textarea></label>
            </div>
            <div class="sheet-two-col">
                <label>Poznámky<textarea name="attr_comprnotes"></textarea></label>
                <hr class="sheet-companion-divider">
            </div>
        </fieldset>
    </div>
</div>
<div class="sheet-actionbar">
    <img src="https://raw.githubusercontent.com/samik027/Roll20-DRDII-character-sheet/5eefd9e80275896c8c4743672ddff384212d2b0b/actionbar.svg" />
</div>

<script type="text/worker">
    const buttonlist = ["character", "texts", "companions"];
    buttonlist.forEach(button => {
        on(`clicked:${button}`, function () {
            setAttrs({
                sheetTab: button
            });
        });
    });
    let resoursebtns = [];
    for (let i = 0; i < 15; i++) {
        resoursebtns.push('resoursebody' + i);
        resoursebtns.push('resoursespirit' + i);
        resoursebtns.push('resourseinfluence' + i);
    }
    resoursebtns.forEach(button => {
        on(`clicked:${button}`, function () {
            getAttrs([button], function (v) {
                let val = Object.values(v)[0];
                let newVal = "/";
                if (val === '/') {
                    newVal = 'X';
                } else if (val === 'X') {
                    newVal = "|";
                } else if (val === '|') {
                    newVal = " ";
                }

                setAttrs({
                    [button]: newVal
                });
            });
        });
    });

    const btnLoad = ['load'];
    btnLoad.forEach(button => {
        on(`clicked:${button}`, function () {
            getAttrs([button], function (v) {
                let val = Object.values(v)[0];
                let newVal = "L";

                if (val === 'L') {
                    newVal = 'S';
                } else if (val === 'S') {
                    newVal = "T";
                }

                setAttrs({
                    [button]: newVal
                });
            });
        });
    });
</script>